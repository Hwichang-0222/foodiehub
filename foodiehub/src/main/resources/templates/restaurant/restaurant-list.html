<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>맛집 목록 | FoodieHub</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

    <!-- 공통 헤더 -->
    <div th:replace="layout/header :: header"></div>

    <main class="restaurant-page">

        <!-- 검색창 -->
        <div class="restaurant-search">
            <form th:action="@{/restaurant/list}" method="get">
                <input type="text" name="keyword" placeholder="맛집 이름을 검색하세요" th:value="${keyword}">
                <button type="submit" class="btn">검색</button>
                <a th:href="@{/restaurant/list}" class="reset-btn">초기화</a>
            </form>
        </div>

        
        <!-- 검색 결과 총 개수 -->
        <div class="result-count" th:if="${totalCount > 0}">
            총 <span th:text="${totalCount}">0</span>개의 맛집이 검색되었습니다.
        </div>
        <div class="result-count" th:if="${totalCount == 0}">
            검색 결과가 없습니다.
        </div>
        

        <!-- 메인 컨테이너 -->
        <div class="restaurant-container-row">

            <!-- 필터 영역 -->
            <div class="filter-bar-row">
                
                <!-- 음식 필터 -->
                <div class="filter-box">
                    <div class="filter-header-single">
                        <a th:href="@{/restaurant/list(region=${region}, keyword=${keyword})}">음식</a>
                    </div>
                    <div class="filter-body-single">
                        <a th:href="@{/restaurant/list(category='한식', region=${region}, keyword=${keyword})}" th:classappend="${category} == '한식' ? 'active' : ''">한식</a>
                        <a th:href="@{/restaurant/list(category='중식', region=${region}, keyword=${keyword})}" th:classappend="${category} == '중식' ? 'active' : ''">중식</a>
                        <a th:href="@{/restaurant/list(category='일식', region=${region}, keyword=${keyword})}" th:classappend="${category} == '일식' ? 'active' : ''">일식</a>
                        <a th:href="@{/restaurant/list(category='양식', region=${region}, keyword=${keyword})}" th:classappend="${category} == '양식' ? 'active' : ''">양식</a>
                        <a th:href="@{/restaurant/list(category='분식', region=${region}, keyword=${keyword})}" th:classappend="${category} == '분식' ? 'active' : ''">분식</a>
                        <a th:href="@{/restaurant/list(category='패스트푸드', region=${region}, keyword=${keyword})}" th:classappend="${category} == '패스트푸드' ? 'active' : ''">패스트푸드</a>
                        <a th:href="@{/restaurant/list(category='카페', region=${region}, keyword=${keyword})}" th:classappend="${category} == '카페' ? 'active' : ''">카페</a>
                        <a th:href="@{/restaurant/list(category='디저트', region=${region}, keyword=${keyword})}" th:classappend="${category} == '디저트' ? 'active' : ''">디저트</a>
                        <a th:href="@{/restaurant/list(category='고기', region=${region}, keyword=${keyword})}" th:classappend="${category} == '고기' ? 'active' : ''">고기</a>
                        <a th:href="@{/restaurant/list(category='해산물', region=${region}, keyword=${keyword})}" th:classappend="${category} == '해산물' ? 'active' : ''">해산물</a>
                        <a th:href="@{/restaurant/list(category='술집', region=${region}, keyword=${keyword})}" th:classappend="${category} == '술집' ? 'active' : ''">술집</a>
                        <a th:href="@{/restaurant/list(category='기타', region=${region}, keyword=${keyword})}" th:classappend="${category} == '기타' ? 'active' : ''">기타</a>
                    </div>
                </div>

                
                <!-- 지역 필터 -->
                <div class="filter-box">
                    <div class="filter-header-single">
                        <a th:href="@{/restaurant/list(category=${category}, keyword=${keyword})}">지역</a>
                    </div>
                    <div class="filter-body-single">
                        <a th:href="@{/restaurant/list(region='서울', category=${category}, keyword=${keyword})}" th:classappend="${region} == '서울' ? 'active' : ''">서울</a>
                        <a th:href="@{/restaurant/list(region='부산', category=${category}, keyword=${keyword})}" th:classappend="${region} == '부산' ? 'active' : ''">부산</a>
                        <a th:href="@{/restaurant/list(region='대구', category=${category}, keyword=${keyword})}" th:classappend="${region} == '대구' ? 'active' : ''">대구</a>
                        <a th:href="@{/restaurant/list(region='인천', category=${category}, keyword=${keyword})}" th:classappend="${region} == '인천' ? 'active' : ''">인천</a>
                        <a th:href="@{/restaurant/list(region='광주', category=${category}, keyword=${keyword})}" th:classappend="${region} == '광주' ? 'active' : ''">광주</a>
                        <a th:href="@{/restaurant/list(region='대전', category=${category}, keyword=${keyword})}" th:classappend="${region} == '대전' ? 'active' : ''">대전</a>
                        <a th:href="@{/restaurant/list(region='울산', category=${category}, keyword=${keyword})}" th:classappend="${region} == '울산' ? 'active' : ''">울산</a>
                        <a th:href="@{/restaurant/list(region='세종', category=${category}, keyword=${keyword})}" th:classappend="${region} == '세종' ? 'active' : ''">세종</a>
                        <a th:href="@{/restaurant/list(region='경기', category=${category}, keyword=${keyword})}" th:classappend="${region} == '경기' ? 'active' : ''">경기</a>
                        <a th:href="@{/restaurant/list(region='강원', category=${category}, keyword=${keyword})}" th:classappend="${region} == '강원' ? 'active' : ''">강원</a>
                        <a th:href="@{/restaurant/list(region='충북', category=${category}, keyword=${keyword})}" th:classappend="${region} == '충북' ? 'active' : ''">충북</a>
                        <a th:href="@{/restaurant/list(region='충남', category=${category}, keyword=${keyword})}" th:classappend="${region} == '충남' ? 'active' : ''">충남</a>
                        <a th:href="@{/restaurant/list(region='전북', category=${category}, keyword=${keyword})}" th:classappend="${region} == '전북' ? 'active' : ''">전북</a>
                        <a th:href="@{/restaurant/list(region='전남', category=${category}, keyword=${keyword})}" th:classappend="${region} == '전남' ? 'active' : ''">전남</a>
                        <a th:href="@{/restaurant/list(region='경북', category=${category}, keyword=${keyword})}" th:classappend="${region} == '경북' ? 'active' : ''">경북</a>
                        <a th:href="@{/restaurant/list(region='경남', category=${category}, keyword=${keyword})}" th:classappend="${region} == '경남' ? 'active' : ''">경남</a>
                        <a th:href="@{/restaurant/list(region='제주', category=${category}, keyword=${keyword})}" th:classappend="${region} == '제주' ? 'active' : ''">제주</a>
                        <a th:href="@{/restaurant/list(region='기타', category=${category}, keyword=${keyword})}" th:classappend="${region} == '기타' ? 'active' : ''">기타</a>
                    </div>
                </div>
            </div>

            <!-- 오른쪽 리스트 -->
            <section class="restaurant-list">
                <div th:if="${#lists.isEmpty(restaurants)}" class="no-result">
                    <p>검색 결과가 없습니다.</p>
                </div>

                <div class="restaurant-item" th:each="r : ${restaurants}">
                    <a th:href="@{'/restaurant/detail/' + ${r.id}}" class="restaurant-link">
                        <img th:src="${r.mainImageUrl}" alt="thumbnail" onerror="this.src='/images/default-thumbnail.png'">
                        <div class="restaurant-info">
                            <h4 th:text="${r.name}">식당 이름</h4>
                            <p th:text="'★ ' + ${r.avgRating} + ' | ' + ${r.category} + ' | ' + ${r.region}"></p>
                            <p th:text="${r.address}"></p>
                        </div>
                    </a>
                </div>
                
                <!-- 페이지네이션 -->
                <div class="pagination">
                    <a th:if="${currentPage > 1}" th:href="@{/restaurant/list(region=${region}, category=${category}, keyword=${keyword}, page=${currentPage - 1})}">« 이전</a>
                    <span th:text="${currentPage}"></span>
                    <a th:if="${currentPage < totalPages}" th:href="@{/restaurant/list(region=${region}, category=${category}, keyword=${keyword}, page=${currentPage + 1})}">다음 »</a>
                </div>
                
            </section>
        </div>
    </main>

    <!-- 공통 푸터 -->
    <div th:replace="layout/footer :: footer"></div>

</body>
</html>