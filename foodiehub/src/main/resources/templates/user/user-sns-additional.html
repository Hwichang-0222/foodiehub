<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>추가 정보 입력 | FoodieHub</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">

    <!-- 공통 주소/지역 JS -->
    <script th:src="@{/js/user-address.js}" defer></script>

    <!-- SNS 추가정보 전용 JS -->
    <script th:src="@{/js/sns-additional-info.js}" defer></script>
</head>
<body>

    <!-- 공통 헤더 -->
    <div th:replace="layout/header :: header"></div>

    <main class="signup-main">
        <section class="signup-container">
            <h2>추가 정보 입력</h2>

            <!-- ============================================
                 SNS 로그인 안내
            ============================================ -->
            <div class="account-badge" 
                 th:classappend="${user.provider == 'kakao' ? 'badge-kakao' : 'badge-naver'}">
                <img th:if="${user.provider == 'kakao'}" 
                     th:src="@{/images/kakao-logo.png}" 
                     alt="카카오" class="badge-logo">
                <img th:if="${user.provider == 'naver'}" 
                     th:src="@{/images/naver-logo.png}" 
                     alt="네이버" class="badge-logo">
                <span th:text="${user.provider == 'kakao' ? '카카오' : '네이버'}"></span> 계정으로 가입
            </div>

            <div class="info-box">
                <p>🎉 환영합니다! 서비스 이용을 위해 추가 정보를 입력해주세요.</p>
            </div>

            <form th:action="@{/user/sns-additional-info}" method="post" 
                  th:object="${user}" id="additionalInfoForm">

                <!-- ============================================
                     기본 정보 (읽기 전용)
                ============================================ -->
                <label>이름</label>
                <input type="text" th:field="*{name}" readonly>

                <label>이메일</label>
                <input type="email" th:field="*{email}" readonly>

                <!-- ============================================
                     추가 정보 입력
                ============================================ -->

                <!-- 휴대폰 번호 -->
                <label>휴대폰 번호 <span class="required">*</span></label>
                <input type="tel" th:field="*{phone}" id="phone" 
                       placeholder="010-1234-5678" required>

                <!-- 생년월일 (SNS에서 받아온 경우 읽기전용) -->
                <label>생년월일 <span class="required">*</span></label>
                <input type="date" th:field="*{birthDate}" id="birthDate" 
                       th:readonly="${user.birthDate != null}" required>

                <!-- 성별 (SNS에서 받아온 경우 읽기전용) -->
                <label>성별 <span class="required">*</span></label>
                <select th:field="*{gender}" id="gender" 
                        th:disabled="${user.gender != null}" required>
                    <option value="">선택하세요</option>
                    <option value="M">남성</option>
                    <option value="F">여성</option>
                    <option value="O">기타</option>
                </select>

                <!-- ============================================
                     주소 (3단 구성)
                ============================================ -->
                <label>주소 <span class="required">*</span></label>

                <!-- 1) 우편번호 -->
                <div class="inline-input">
                    <input type="text" id="baseAddress" placeholder="우편번호" readonly required>
                    <button type="button" class="check-btn" onclick="openAddressSearch()">주소 검색</button>
                </div>

                <!-- 2) 도로명 주소 -->
                <input type="text" id="roadAddr" placeholder="도로명 주소" readonly>

                <!-- 3) 상세주소 -->
                <input type="text" id="detail" placeholder="상세주소 (건물명/동·호수 등)">

                <!-- hidden: 최종 조립 주소 -->
                <input type="hidden" th:field="*{address}" id="address">

                <!-- hidden: region level -->
                <input type="hidden" th:field="*{regionLevel1}" id="region_level1">
                <input type="hidden" th:field="*{regionLevel2}" id="region_level2">
                <input type="hidden" th:field="*{regionLevel3}" id="region_level3">

                <!-- ============================================
                     제출 버튼
                ============================================ -->
                <button type="submit" class="submit-btn">완료</button>

                <!-- 에러 메시지 -->
                <p th:if="${error}" th:text="${error}" class="error-message"></p>
            </form>
        </section>
    </main>

    <!-- 공통 푸터 -->
    <div th:replace="layout/footer :: footer"></div>

</body>
</html>